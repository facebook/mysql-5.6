DROP TABLE IF EXISTS tbl1;
DROP TABLE IF EXISTS tbl2;
DROP DATABASE IF EXISTS cus_test;
CREATE DATABASE cus_test;
USE cus_test;
CREATE TABLE tbl1 (
col1_1 INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
col1_2 INT NOT NULL,
col1_3 INT NOT NULL,
col1_4 INT NOT NULL);
INSERT INTO tbl1 (col1_2, col1_3, col1_4) VALUES (2, 3, 4);
INSERT INTO tbl1 (col1_2, col1_3, col1_4) VALUES (3, 4, 5);
INSERT INTO tbl1 (col1_2, col1_3, col1_4) VALUES (4, 5, 6);
CREATE TABLE tbl2 (col2_1 INT NOT NULL, col2_2 INT NOT NULL);
INSERT INTO tbl2 (col2_1, col2_2) VALUES (2, 3);
CREATE TABLE tbl3 (
col1_1 INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
col1_2 INT NOT NULL,
col3_3 INT NOT NULL);
INSERT INTO tbl3 (col1_2, col3_3) VALUES (2, 83);
INSERT INTO tbl3 (col1_2, col3_3) VALUES (3, 84);
INSERT INTO tbl3 (col1_2, col3_3) VALUES (4, 85);
set global column_stats_control = ON;
SELECT col1_2, col1_3 FROM (SELECT col1_2, col1_3, col1_4 FROM tbl1
WHERE col1_4 < 10 ) t WHERE col1_3 IN (2, 5, 6, 7);
col1_2	col1_3
4	5
SELECT col1_1, col1_2 FROM tbl1 WHERE col1_3 IN (SELECT col2_1 FROM tbl2 WHERE col2_2 <> 3);
col1_1	col1_2
UPDATE tbl1 SET col1_3 = 1 WHERE col1_2 IN (SELECT col2_2 FROM tbl2 WHERE col2_1 < 5);
DELETE FROM tbl1 WHERE col1_2 IN (SELECT col2_2 FROM tbl2 WHERE col2_1 < 5);
SELECT COUNT(DISTINCT SQL_ID) FROM performance_schema.column_statistics;
COUNT(DISTINCT SQL_ID)
4
SELECT SQL_ID, TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME, SQL_OPERATION, OPERATOR_TYPE
FROM performance_schema.column_statistics;
SQL_ID	TABLE_SCHEMA	TABLE_NAME	COLUMN_NAME	SQL_OPERATION	OPERATOR_TYPE
01165335f0b0aa5184deb3cd1df797e5179f686461b35aed096b6cf6a43a6ffc	cus_test	tbl1	col1_4	FILTER	LESS_THAN
44eb9130b84778f5f9c673faa7f424c002943a48bc77465a7cf5c24a8c76f222	cus_test	tbl1	col1_3	FILTER	EQUAL
44eb9130b84778f5f9c673faa7f424c002943a48bc77465a7cf5c24a8c76f222	cus_test	tbl2	col2_1	FILTER	EQUAL
44eb9130b84778f5f9c673faa7f424c002943a48bc77465a7cf5c24a8c76f222	cus_test	tbl2	col2_2	FILTER	NOT_EQUAL
6d83cb5f46048fdd1fa0342001726bb6a8df04fed88de9d5434e5b2f28b0edbd	cus_test	tbl1	col1_2	FILTER	EQUAL
6d83cb5f46048fdd1fa0342001726bb6a8df04fed88de9d5434e5b2f28b0edbd	cus_test	tbl2	col2_1	FILTER	LESS_THAN
6d83cb5f46048fdd1fa0342001726bb6a8df04fed88de9d5434e5b2f28b0edbd	cus_test	tbl2	col2_2	FILTER	EQUAL
efe375234bfa24c13b59dbbff4fec13f47780ed6ecbf74a325c4b8e62eadd3c9	cus_test	tbl1	col1_2	FILTER	EQUAL
efe375234bfa24c13b59dbbff4fec13f47780ed6ecbf74a325c4b8e62eadd3c9	cus_test	tbl2	col2_1	FILTER	LESS_THAN
efe375234bfa24c13b59dbbff4fec13f47780ed6ecbf74a325c4b8e62eadd3c9	cus_test	tbl2	col2_2	FILTER	EQUAL
set global column_stats_control = OFF_HARD;
DROP TABLE tbl1;
DROP TABLE tbl2;
DROP TABLE tbl3;
DROP DATABASE cus_test;

--source include/have_rocksdb.inc

--let $engine = InnoDB 

--eval CREATE TABLE t1 (id INT AUTO_INCREMENT PRIMARY KEY) ENGINE=$engine PARTITION BY RANGE(id) (PARTITION p0 VALUES LESS THAN (10), PARTITION p1 VALUES LESS THAN (20), PARTITION p2 VALUES LESS THAN (30), PARTITION p3 VALUES LESS THAN (40), PARTITION p4 VALUES LESS THAN (50), PARTITION p5 VALUES LESS THAN MAXVALUE);
INSERT INTO t1 VALUES (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL),
  (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL),
  (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL),
  (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL),
  (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL),
  (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL), (NULL);
SELECT COUNT(id) FROM t1;

# data from p3 reorganized into p4
ALTER TABLE t1 ALGORITHM=COPY, DROP PARTITION p3;
SELECT COUNT(id) FROM t1;
SELECT COUNT(id) FROM t1 WHERE id >= 30 AND id < 40;

# data from p2 deleted from table
ALTER TABLE t1 ALGORITHM=INPLACE, DROP PARTITION p2;
SELECT COUNT(id) FROM t1;
SELECT COUNT(id) FROM t1 WHERE id >= 20 AND id < 30;

DROP TABLE t1;
